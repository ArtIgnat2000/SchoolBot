# üîß –†–µ—à–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ CPU CFS scheduler –Ω–∞ Synology

## ‚ùå –û—à–∏–±–∫–∞
```
Error response from daemon: NanoCPUs can not be set, as your kernel does not support CPU CFS scheduler or the cgroup is not mounted
```

## üéØ –ü—Ä–∏—á–∏–Ω–∞
Synology NAS –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è CPU —á–µ—Ä–µ–∑ Docker Compose –∏–ª–∏ cgroup –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

## ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (–±–µ–∑ CPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
docker-compose -f docker-compose.synology-compatible.yml up -d
```

### –†–µ—à–µ–Ω–∏–µ 2: –ß–µ—Ä–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π deploy-synology.sh –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ø—Ä–æ–±–ª–µ–º—É
bash deploy-synology.sh
# –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 3) –°–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å —Å—Ç–∞—Ä—ã–º–∏ Synology
```

### –†–µ—à–µ–Ω–∏–µ 3: –†—É—á–Ω–æ–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `docker-compose.synology.yml`:
```yaml
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ —Å–µ–∫—Ü–∏—é CPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
deploy:
  resources:
    limits:
      memory: 256M
      # cpus: '0.5'  # –û—Ç–∫–ª—é—á–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É
    reservations:
      memory: 128M
      # cpus: '0.25'  # –û—Ç–∫–ª—é—á–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É
```

### –†–µ—à–µ–Ω–∏–µ 4: –ó–∞–ø—É—Å–∫ –±–µ–∑ deploy —Å–µ–∫—Ü–∏–∏
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é docker-compose.yml
# –£–¥–∞–ª–∏—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–µ–∫—Ü–∏—é deploy:
```

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `deploy-synology.sh` —Ç–µ–ø–µ—Ä—å:
1. **–ü—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å** —Å –æ–±—ã—á–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
2. **–û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ—à–∏–±–∫—É** CFS scheduler
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è** –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –≤–µ—Ä—Å–∏—é
4. **–ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É** –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π CPU

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | CPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|------|----------|-----------------|
| `docker-compose.yml` | –ë–∞–∑–æ–≤–∞—è | –ù–µ—Ç |
| `docker-compose.synology.yml` | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è | –ï—Å—Ç—å (–º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å) |
| `docker-compose.synology-compatible.yml` | –°–æ–≤–º–µ—Å—Ç–∏–º–∞—è | –û—Ç–∫–ª—é—á–µ–Ω—ã |

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –î–ª—è —Å—Ç–∞—Ä—ã—Ö Synology NAS:
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose -f docker-compose.synology-compatible.yml up -d --build

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker logs school-bot -f
```

### –î–ª—è –Ω–æ–≤—ã—Ö Synology NAS:
```bash
# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
docker-compose -f docker-compose.synology.yml up -d

# –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é
docker-compose -f docker-compose.synology-compatible.yml up -d
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ CFS scheduler:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ cgroup
mount | grep cgroup

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CPU controller
cat /proc/cgroups | grep cpu

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —è–¥—Ä–µ
uname -a
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π:
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Docker
docker info | grep -i cpu

# –í–µ—Ä—Å–∏—è Docker Compose
docker-compose --version
```

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker run –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```bash
# –ó–∞–ø—É—Å–∫ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ docker run
docker run -d \
  --name school-bot \
  --memory=256m \
  --restart=unless-stopped \
  --env-file .env \
  school-bot:latest
```

## ‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- **CPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è Telegram –±–æ—Ç–∞
- **–ü–∞–º—è—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- **–ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å** –±–µ–∑ CPU –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- **Performance** –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø—Ä–∏–µ–º–ª–µ–º—ã–º –¥–ª—è NAS

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—à–µ–Ω–∏—è

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ª—é–±–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:
```bash
# –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫
docker ps
docker logs school-bot --tail 20

# –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—á–∞—Ç—å –≤ Telegram
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –±–æ—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```

---

**üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –î–ª—è Synology NAS –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `docker-compose.synology-compatible.yml` - —ç—Ç–æ –∏–∑–±–∞–≤–∏—Ç –æ—Ç –ø—Ä–æ–±–ª–µ–º —Å CFS scheduler –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É.