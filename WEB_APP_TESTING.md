# Тестирование Web App интеграции

## Примеры данных для тестирования

### 1. Данные расписания
```json
{
  "schedule": {
    "day": "Понедельник",
    "class": "3В",
    "lessons": [
      {"time": "8:30-9:10", "subject": "Пустой урок"},
      {"time": "9:30-10:10", "subject": "Математика"},
      {"time": "10:20-11:00", "subject": "Русский язык"}
    ]
  }
}
```

### 2. Данные заказа (для будущего использования)
```json
{
  "order": {
    "customer": "Иван Иванов",
    "total": 500,
    "items": ["Тетрадь", "Ручка", "Карандаш"]
  }
}
```

### 3. Общие данные
```json
{
  "action": "test",
  "timestamp": "2025-10-20T10:00:00",
  "user_data": {
    "name": "Test User",
    "preferences": ["math", "science"]
  }
}
```

## Безопасность обработки

Обработчик `handle_web_app_data` теперь включает:

1. **Проверка на None**: `if not message.web_app_data or not message.web_app_data.data:`
2. **Обработка JSON ошибок**: `except json.JSONDecodeError as e:`
3. **Общая обработка исключений**: `except Exception as e:`
4. **Типизация данных**: Разные обработчики для разных типов данных

## Структура обработчиков

- `handle_web_app_data()` - главный обработчик с проверками
- `handle_schedule_data()` - специальный обработчик для данных расписания
- `handle_order_data()` - обработчик для данных заказов (на будущее)

## Возможные ошибки и их обработка

1. **web_app_data is None** - возвращает сообщение об ошибке
2. **web_app_data.data is None/empty** - возвращает сообщение об ошибке
3. **Неверный JSON** - сообщение о формате данных
4. **Общие исключения** - универсальное сообщение об ошибке

## Тестирование

Для тестирования Web App:
1. Откройте бота
2. Перейдите в "Школьные дела" → "Открыть веб-расписание" → "Web App (в Telegram)"
3. Взаимодействуйте с веб-приложением
4. Данные будут безопасно обработаны ботом